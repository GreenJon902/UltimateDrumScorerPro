#:kivy 2.1.0
#:include score/scoreSettings.kv

<Decoration>:
    size_hint: None, None

    canvas.before:
        Color:
            rgba: 1, 0, 0, 0#.2
        Rectangle:
            size: self.size

<Rest1@Decoration>:
    width: 5
    min_height: 10

    RelativeLayout:
        size_hint_y: None
        height: root.min_height
        center_y: root.height / 2

        canvas:
            Color:
                rgba: root.color
            Line:
                points: 0, 10, 5, 7.5, 1, 5
                width: st
            Line:
                points: 4, 8, 0, 5.5, 5, 2.5, 2, 2
                width: st
            Line:
                ellipse: 0, 0, 5, 2, -10, -270
                width: st

<Rest2@Decoration>:  # TODO: Find a better system for making all rests (not1 beat ones) into one widget
    width: 3
    min_height: 5

    RelativeLayout:
        size_hint_y: None
        height: root.min_height
        center_y: root.height / 2

        canvas:
            Color:
                rgba: root.color
            Line:
                points: 1, 0, 3, 5
                width: st
            Line:
                ellipse: 0, 4, 3, 2, 90, 270
                width: st

<Rest4@Decoration>:  # TODO: Find a better system for making all rests (not1 beat ones) into one widget
    width: 4
    min_height: 5

    RelativeLayout:
        size_hint_y: None
        height: root.min_height
        center_y: root.height / 2

        canvas:
            Color:
                rgba: root.color
            Line:
                points: 2, 0, 4, 5
                width: st
            Line:
                ellipse: 1, 4, 3, 2, 90, 270
                width: st
            Line:
                ellipse: 0.45, 2.5, 3, 2, 130, 270
                width: st

<BarSeparator@Decoration>:
    width: 0
    min_height: 5

    canvas:
        Color:
            rgba: root.color
        Line:
            points: 0, 0, 0, self.height
            width: st

<SectionStart@Decoration>:
    width: 2
    min_height: 7

    canvas:
        Color:
            rgba: root.color
        Line:
            points: 0, 0, 0, self.height
            width: st
        Ellipse:
            pos: 1, self.height / 2 + 2
            size: 1, 1
        Ellipse:
            pos: 1, self.height / 2 - 3
            size: 1, 1

<SectionEnd@Decoration>:
    width: 2
    min_height: 7

    canvas:
        Color:
            rgba: root.color
        Line:
            points: 2, 0, 2, self.height
            width: st
        Ellipse:
            pos: 0, self.height / 2 + 2
            size: 1, 1
        Ellipse:
            pos: 0, self.height / 2 - 3
            size: 1, 1

<RepeatedSectionStart@Decoration>:
    width: 3
    min_height: 15

    canvas:
        Color:
            rgba: root.color
        Line:
            points: 3, -1.5, 0, 0, 0, self.height, 3, self.height + 1.5
            width: st
        Line:
            points: 1, self.height / 2 - 4, 1, self.height / 2 + 4
            width: st
        Ellipse:
            pos: 2, self.height / 2 + 2
            size: 1, 1
        Ellipse:
            pos: 2, self.height / 2 - 3
            size: 1, 1

<RepeatedSectionStop@Decoration>:
    width: 3
    min_height: 15

    canvas:
        PushMatrix
        Scale:  # Ye so i didnt wanna change the points so you get this instead :)
            xyz: -1, 1, 1
        Translate:
            xyz: -3, 0, 0

        Color:
            rgba: root.color
        Line:
            points: 3, -1.5, 0, 0, 0, self.height, 3, self.height + 1.5
            width: st
        Line:
            points: 1, self.height / 2 - 4, 1, self.height / 2 + 4
            width: st
        Ellipse:
            pos: 2, self.height / 2 + 2
            size: 1, 1
        Ellipse:
            pos: 2, self.height / 2 - 3
            size: 1, 1

        PopMatrix

#:set decorations {0: "Rest1", 1: "Rest2", 2: "Rest4", 3: "BarSeparator", 4: "SectionStart", 5: "SectionEnd", 6: "RepeatedSectionStart", 7: "RepeatedSectionStop"}